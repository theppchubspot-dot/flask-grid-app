<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Workspace</title>

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.css">
  <link rel="stylesheet" href="/static/css/main.css">
</head>
<body>

<div class="top">
  {% for g in grids|sort(attribute='pinned', reverse=True) %}
    <div class="tab-wrap {% if g.id == grid_id %}active-wrap{% endif %}">
      
      <a href="/workspace/{{ g.id }}"
         class="tab {% if g.id == grid_id %}active{% endif %}"
         ondblclick="renameByDblClick(event, {{ g.id }}, '{{ g.title }}')"
         oncontextmenu="openMenu(event, {{ g.id }}, '{{ g.title }}')">

        {% if g.pinned %}ðŸ“Œ{% endif %} {{ g.title }}
      </a>

      {% if g.id == grid_id %}
        <!-- Pin -->
        <a href="/pin-grid/{{ g.id }}" class="icon">ðŸ“Œ</a>

        <!-- Delete -->
        <a href="/delete-grid/{{ g.id }}"
           class="icon delete"
           onclick="return confirm('Delete this sheet?')">
           ðŸ—‘
        </a>
      {% endif %}
    </div>
  {% endfor %}

  <!-- Add new sheet -->
  <a href="/create-grid" class="tab add">ï¼‹</a>

  <!-- Download Excel -->
  <a href="/download-excel/{{ grid_id }}" class="tab download">
    â¬‡ Excel
  </a>

  <!-- Logout -->
  <a href="/logout" class="logout">Logout</a>
</div>

<!-- SHARE FORM -->
<div class="share-bar">
  <form method="POST" action="/share-grid/{{ grid_id }}" class="share-form">
    <input
      type="email"
      name="email"
      placeholder="Share with email"
      required
    >
    <button type="submit">Share</button>
  </form>
</div>

  <div class="sheet-actions">
  <button class="add-col-btn" onclick="hot.alter('insert_col')">
    âž• Add Column
  </button>
</div>

<!-- GRID -->
<div id="grid"></div>

<script>
  const GRID_DATA = {{ grid_data | tojson }};
  const GRID_ID = {{ grid_id }};
</script>

<script src="https://cdn.jsdelivr.net/npm/handsontable/dist/handsontable.full.min.js"></script>
<script src="/static/js/grid.js"></script>

<!-- RIGHT CLICK MENU -->
<div id="contextMenu" class="context-menu">
  <div onclick="renameSheet()">Rename</div>
  <div onclick="pinSheet()">Pin / Unpin</div>
  <div onclick="deleteSheet()">Delete</div>
</div>

</body>
</html>

